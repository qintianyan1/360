(function(e){try{var t=e.document,n=t.documentElement,r=0,i=0,s=t.querySelector('meta[name="viewport"]');if(s){console.warn("\u5c06\u6839\u636e\u5df2\u6709\u7684meta\u6807\u7b7e\u6765\u8bbe\u7f6e\u7f29\u653e\u6bd4\u4f8b");var o=s.getAttribute("content").match(/initial\-scale=([\d\.]+)/);o&&(i=parseFloat(o[1]),r=parseInt(1/i))}if(!r&&!i){var u=e.navigator.appVersion.match(/iphone/gi),a=e.devicePixelRatio;u?a>=3&&(!r||r>=3)?r=3:a>=2&&(!r||r>=2)?r=2:r=1:r=1,i=1/r}n.setAttribute("data-dpr",r);if(!s){s=t.createElement("meta"),s.setAttribute("name","viewport"),s.setAttribute("content","initial-scale="+i+", maximum-scale="+i+", minimum-scale="+i+", user-scalable=no");if(n.firstElementChild)n.firstElementChild.appendChild(s);else{var f=t.createElement("div");f.appendChild(s),t.write(f.innerHTML)}}function l(){var e=n.getBoundingClientRect().width;e/r>640&&(e=640*r),n.style.fontSize=20*(e/320)+"px"}l();var c="orientationchange"in window?"orientationchange":"resize",h;e.addEventListener(c,function(){clearTimeout(h),h=setTimeout(l,300)},!1),e.addEventListener("pageshow",function(e){e.persisted&&(clearTimeout(h),h=setTimeout(l,300))},!1);if(t.readyState==="complete")t.body.style.fontSize=16*r+"px";else{if(!t.addEventListener)return;t.addEventListener("DOMContentLoaded",function(e){t.body.style.fontSize=16*r+"px"},!1)}}catch(p){console.error(p)}})(window);var ac=function(){var e=function(e){var t=$(e);t&&($(window).on("scroll",function(){$(window).scrollTop()>300?t.show():t.hide()}),t.find(".mao").on("click",function(){t.find(" li").removeClass("active"),$(this).closest("li").addClass("active");var e=$(this).data("href"),n=$(e).offset().top-t.height();$("body").scrollTop(n)}))},t=function(e){var t=$(".countdown"),n=0,r=function(){},i=function(e,t){e.html(t.day+"\u5929"+t.hour+"\u65f6"+t.minute+"\u5206"+t.second+"\u79d2"+t.msecond)},s=+(new Date),o=function(e){var s=e||{};t=$(s.eleRemain),t&&(n=parseInt(t.attr("data-countdown"))),i=s.update||i,r=s.callback,n>0&&a()},u=function(e){var n={msecond:Math.floor(e%1e3/10),second:Math.floor(e/1e3)%60,minute:Math.floor(e/1e3/60%60),hour:Math.floor(e/1e3/60/60%24),day:Math.floor(e/1e3/60/60/24)};typeof i=="function"&&i(t,n)},a=function(){var e=n*1e3+s-new Date;e>0?(u(e),setTimeout(a,30)):typeof r=="function"&&r(t)};o(e)},n=function(e,t){e&&e.length>0&&t&&$.get("/activity/getitembyinfo",{item_id:e.join("_")},function(e){e.errno==0?e.data&&($.each(e.data,function(e,t){t.img_content&&t.img_content.length>0&&(t.img_url=t.img_content[0]),t.price_market=Math.round(parseFloat(t.price_market)*100)/100,t.price_sale=Math.round(parseFloat(t.price_sale)*100)/100,t.price_market&&t.price_market>t.price_sale&&(t.discount=Math.round((t.price_market-t.price_sale)*100)/100)}),t(e.data)):qk.dialog.alert(e.errmsg)},"jsonp")},r=function(e){var t=[];e.find(".ac-mod-list .item").each(function(){var e=$(this).data("itemid");e&&t.push(e)}),n(t,function(t){e.find(".ac-mod-list .item").each(function(){var e=$(this).data("itemid"),n=t[e];n&&$(this).html(template("tpl-item",n))}),window.echo&&echo.init({})})},i=function(){return"qikooapp"==navigator.userAgent.toLowerCase().match(/QikooApp/i)},s=function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},o=function(){return navigator.userAgent.indexOf("Android")>=0||navigator.userAgent.indexOf("Linux")>=0},u=function(){ac.inApp()&&$(".bottom1").remove();var e=window.get_share_message();window.get_share_message=function(){return e.web_page_url=window.ac_share_datas.url||e.web_page_url,e.title=window.ac_share_datas.title||e.title,e.thumb_image_url=window.ac_share_datas.img||e.thumb_image_url,e}},a=function(e,t){t||(t=".coupon"),$("body").on("click",t,function(){var t=$(this).data("type"),n=$(this).data("batch"),r=$(this).data("url"),i=$(this).data("hash");r||(r="/activity/couponrolesalecode");var s=this;QHPass.getUserInfo(function(){$(s).data("running")||($(s).data("running",!0),$.get(r,{id:t,batchid:n},function(t){$(s).data("running",!1),t=typeof t=="object"?t:JSON.parse(t),e?t.errno==0?e():t.errno=="40003"?qk.dialog.alert(t.errmsg,function(){e()}):qk.dialog.alert(t.errmsg):qk.dialog.alert(t.errmsg)},"jsonp"))},function(){f(i)})})},f=function(e){ac.inApp()?(window.login_finish=function(){e?window.location.href=window.location.href+e:setTimeout(function(){window.location.reload()},200)},window.bridge&&window.bridge.login()):e?qk.passport.login(location.href+e):qk.passport.login()},l=function(){var e=$(".seckilling"),t=function(){e&&e.each(function(){var e=$(this).find(".seckilling-tab-nav"),t=$(this).find(".seckilling-tab-content");r(e,t)}),i(e)},r=function(e,t){e.find("li").on("click",function(){s(e,t,$(this).index())});var n=e.find(".cur").index();s(e,t,n)},i=function(e){var t=[],r=e.find("dl");r.each(function(){$(this).data("item_id")&&t.push($(this).data("item_id"))}),n(t,function(e){r.each(function(){var t=$(this),n=t.data("item_id"),r=t.data("putong"),i=t.data("num")==1?!0:!1,s=t.data("discount")==1?!0:!1,o=t.parent();if(n&&e[n]){var u=e[n];u.rush_item==1?(u.price_desc="\u79d2\u6740\u4ef7",u.status==0?(u.btnClass="btn-wait",u.btnTxt="\u5373\u5c06\u5f00\u542f",o.attr("href","/rush/item?item_id="+n)):u.status==1?(u.btnClass="btn-buy",u.btnTxt="\u7acb\u5373\u79d2\u6740",o.attr("href","/rush/item?item_id="+n)):u.status==2&&(u.btnClass="btn-miaowan",u.btnTxt="\u5df2\u79d2\u5b8c,\u67e5\u770b\u7279\u60e0\u5546\u54c1",o.attr("href","/shop/item?item_id="+(r?r:n)))):(u.sold_out==1?(u.btnClass="btn-soldout",u.btnTxt="\u5df2\u552e\u5b8c"):(u.btnClass="btn-buy",u.btnTxt="\u7acb\u5373\u8d2d\u4e70"),o.attr("href","/shop/item?item_id="+n)),u.rush_num=i?u.rush_num:0,u.discount=s?u.discount:0,t.html(template("tpl-seckilling-item",u))}})})},s=function(e,t,n){e.find("li").removeClass("cur"),e.find("li:nth-child("+(n+1)+")").addClass("cur"),t.find(".seckilling-tab").addClass("hide"),t.find(".seckilling-tab:nth-child("+(n+1)+")").removeClass("hide")};t()};return{init:u,floatwindow:e,countdown:t,getAllItems:r,inApp:i,inWeixin:s,inAndroid:o,initCoupon:a,showlogin:f,initSeckilling:l}}();